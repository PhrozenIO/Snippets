// Jean-Pierre LESUEUR (@DarkCoderSc)

uses
  System.SysUtils, Winapi.Windows;

// ...

function ActiveWindowTitle() : String;
begin
  result := '';
  ///

  var AWindow : THandle := GetForegroundWindow();
  if AWindow = 0 then
    raise EWindowsException.Create('GetForegroundWindow');

  var ACaptionLen := GetWindowTextLengthW(AWindow);
  if ACaptionLen = 0 then
    Exit(); // Possibly empty caption

  // Include terminating NULL characters
  Inc(ACaptionLen);

  var ACaptionSize := ACaptionLen * SizeOf(WideChar);

  var pBuffer : PWideChar;
  GetMem(pBuffer, ACaptionSize);
  try
    if GetWindowTextW(AWindow, pBuffer, ACaptionLen) = 0 then
      raise EWindowsException.Create('GetWindowTextW');

    ///
    result := String(pBuffer);
  finally
    FreeMem(pBuffer, ACaptionSize);
  end;
end;

// ...

WriteLn(ActiveWindowTitle());